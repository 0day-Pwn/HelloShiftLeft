{
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "Class file analyzer",
          "rules": [
            {
              "id": "CWE-212",
              "name": "Unexpected property leak",
              "fullDescription": "",
              "helpUri": "https://cwe.mitre.org/data/definitions/212.html",
              "shortDescription": ""
            },
            {
              "id": "CWE-915",
              "name": "Mass assignment",
              "fullDescription": "",
              "helpUri": "https://cwe.mitre.org/data/definitions/915.html",
              "shortDescription": ""
            },
            {
              "id": "CWE-502",
              "name": "Object deserialization is used in {1}",
              "fullDescription": "",
              "helpUri": "https://cwe.mitre.org/data/definitions/502.html",
              "shortDescription": ""
            },
            {
              "id": "CWE-79",
              "name": "Potential XSS in Servlet",
              "fullDescription": "",
              "helpUri": "https://cwe.mitre.org/data/definitions/79.html",
              "shortDescription": ""
            },
            {
              "id": "CWE-352",
              "name": "Spring CSRF unrestricted RequestMapping",
              "fullDescription": "",
              "helpUri": "https://cwe.mitre.org/data/definitions/352.html",
              "shortDescription": ""
            },
            {
              "id": "CWE-22",
              "name": "Potential Path Traversal (file read)",
              "fullDescription": "",
              "helpUri": "https://cwe.mitre.org/data/definitions/22.html",
              "shortDescription": ""
            },
            {
              "id": "CWE-203",
              "name": "Unsafe hash equals",
              "fullDescription": "",
              "helpUri": "https://cwe.mitre.org/data/definitions/203.html",
              "shortDescription": ""
            },
            {
              "id": "CWE-328",
              "name": "MD2, MD4 and MD5 are weak hash functions",
              "fullDescription": "",
              "helpUri": "https://cwe.mitre.org/data/definitions/328.html",
              "shortDescription": ""
            },
            {
              "id": "CWE-94",
              "name": "Potential code injection when using Spring Expression",
              "fullDescription": "",
              "helpUri": "https://cwe.mitre.org/data/definitions/94.html",
              "shortDescription": ""
            }
          ]
        }
      },
      "conversion": {
        "tool": {
          "driver": {
            "name": "@ShiftLeft/sast-scan"
          }
        },
        "invocation": {
          "arguments": [
            "-jar",
            "/opt/spotbugs/lib/spotbugs.jar",
            "-textui",
            "-include",
            "/usr/local/src/spotbugs/include.xml",
            "-exclude",
            "/usr/local/src/spotbugs/exclude.xml",
            "-noClassOk",
            "-auxclasspathFromFile",
            "/tmp/tmp1bzbu8ku",
            "-sourcepath",
            "/app",
            "-quiet",
            "-medium",
            "-xml:withMessages",
            "-effort:max",
            "-nested:false",
            "-output",
            "/app/reports/class-report.xml",
            "/app"
          ],
          "executionSuccessful": true,
          "commandLine": "-jar /opt/spotbugs/lib/spotbugs.jar -textui -include /usr/local/src/spotbugs/include.xml -exclude /usr/local/src/spotbugs/exclude.xml -noClassOk -auxclasspathFromFile /tmp/tmp1bzbu8ku -sourcepath /app -quiet -medium -xml:withMessages -effort:max -nested:false -output /app/reports/class-report.xml /app",
          "endTimeUtc": "2020-04-15T12:46:29Z",
          "workingDirectory": {
            "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft"
          }
        }
      },
      "invocations": [
        {
          "executionSuccessful": true,
          "endTimeUtc": "2020-04-15T12:46:29Z",
          "workingDirectory": {
            "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft"
          }
        }
      ],
      "properties": {
        "metrics": {
          "total": 20,
          "critical": 5,
          "high": 15,
          "medium": 0,
          "low": 0
        }
      },
      "results": [
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt AccountController.java:[lines 21-71] \nIn class io.shiftleft.controller.AccountController \nIn method io.shiftleft.controller.AccountController.addInterestToAccount(double, long) \nAt AccountController.java:[lines 67-71]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        Account account = this.accountRepository.findOne(accountId);\n"
                  },
                  "startLine": 67
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    public Account addInterestToAccount(@RequestParam double amount, @PathVariable long accountId) {\n        Account account = this.accountRepository.findOne(accountId);\n"
                  },
                  "endLine": 67,
                  "startLine": 66
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt AccountController.java:[lines 21-71] \nIn class io.shiftleft.controller.AccountController \nIn method io.shiftleft.controller.AccountController.createAccount(Account) \nAt AccountController.java:[lines 36-38]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        this.accountRepository.save(account);\n"
                  },
                  "startLine": 36
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    public Account createAccount(Account account) {\n        this.accountRepository.save(account);\n"
                  },
                  "endLine": 36,
                  "startLine": 35
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt AccountController.java:[lines 21-71] \nIn class io.shiftleft.controller.AccountController \nIn method io.shiftleft.controller.AccountController.depositIntoAccount(double, long) \nAt AccountController.java:[lines 49-53]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        Account account = this.accountRepository.findOne(accountId);\n"
                  },
                  "startLine": 49
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    public Account depositIntoAccount(@RequestParam double amount, @PathVariable long accountId) {\n        Account account = this.accountRepository.findOne(accountId);\n"
                  },
                  "endLine": 49,
                  "startLine": 48
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt AccountController.java:[lines 21-71] \nIn class io.shiftleft.controller.AccountController \nIn method io.shiftleft.controller.AccountController.getAccount(long) \nAt AccountController.java:[lines 43-44]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        log.info(\"Account Data is {}\", this.accountRepository.findOne(1l).toString());\n"
                  },
                  "startLine": 43
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    public Account getAccount(@PathVariable long accountId) {\n        log.info(\"Account Data is {}\", this.accountRepository.findOne(1l).toString());\n"
                  },
                  "endLine": 43,
                  "startLine": 42
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt AccountController.java:[lines 21-71] \nIn class io.shiftleft.controller.AccountController \nIn method io.shiftleft.controller.AccountController.getAccountList(HttpServletResponse, HttpServletRequest) \nAt AccountController.java:[lines 29-31]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        response.addHeader(\"test-header-detection\", new Account().toString());\n"
                  },
                  "startLine": 29
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    public Iterable<Account> getAccountList(HttpServletResponse response, HttpServletRequest request) {\n        response.addHeader(\"test-header-detection\", new Account().toString());\n"
                  },
                  "endLine": 29,
                  "startLine": 28
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt AccountController.java:[lines 21-71] \nIn class io.shiftleft.controller.AccountController \nIn method io.shiftleft.controller.AccountController.withdrawFromAccount(double, long) \nAt AccountController.java:[lines 58-62]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        Account account = this.accountRepository.findOne(accountId);\n"
                  },
                  "startLine": 58
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    public Account withdrawFromAccount(@RequestParam double amount, @PathVariable long accountId) {\n        Account account = this.accountRepository.findOne(accountId);\n"
                  },
                  "endLine": 58,
                  "startLine": 57
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "The persistent objects could be exploited by attacker to read sensitive information. \nAt AccountController.java:[lines 21-71] \nIn class io.shiftleft.controller.AccountController \nIn method io.shiftleft.controller.AccountController.createAccount(Account) \nAt AccountController.java:[lines 36-38]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        this.accountRepository.save(account);\n"
                  },
                  "startLine": 36
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    public Account createAccount(Account account) {\n        this.accountRepository.save(account);\n"
                  },
                  "endLine": 36,
                  "startLine": 35
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-915",
          "ruleIndex": 1
        },
        {
          "message": {
            "text": "Object deserialization is used in io.shiftleft.controller.AdminController.isAdmin(String) \nAt AdminController.java:[lines 27-135] \nIn class io.shiftleft.controller.AdminController \nIn method io.shiftleft.controller.AdminController.isAdmin(String) \nAt AdminController.java:[line 36]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "      Object authToken = objectInputStream.readObject();\n"
                  },
                  "startLine": 36
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AdminController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "      ObjectInputStream objectInputStream = new ObjectInputStream(bis);\n      Object authToken = objectInputStream.readObject();\n"
                  },
                  "endLine": 36,
                  "startLine": 35
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "CRITICAL"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-502",
          "ruleIndex": 2
        },
        {
          "message": {
            "text": "This use of javax/servlet/ServletOutputStream.println(Ljava/lang/String;)V could be vulnerable to XSS in the Servlet \nAt AdminController.java:[lines 27-135] \nIn class io.shiftleft.controller.AdminController \nIn method io.shiftleft.controller.AdminController.doGetPrintSecrets(String, HttpServletResponse, HttpServletRequest) \nAt AdminController.java:[line 66] \nSink method javax/servlet/ServletOutputStream.println(Ljava/lang/String;)V \nSink parameter 0 \nAt AdminController.java:[line 66]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "      response.getOutputStream().println(new String(bdata, StandardCharsets.UTF_8));\n"
                  },
                  "startLine": 66
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AdminController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "      byte[] bdata = FileCopyUtils.copyToByteArray(cpr.getInputStream());\n      response.getOutputStream().println(new String(bdata, StandardCharsets.UTF_8));\n"
                  },
                  "endLine": 66,
                  "startLine": 65
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-79",
          "ruleIndex": 3
        },
        {
          "message": {
            "text": "Unrestricted Spring's RequestMapping makes the method vulnerable to CSRF attacks \nAt AppErrorController.java:[lines 34-103] \nIn class io.shiftleft.controller.AppErrorController \nIn method io.shiftleft.controller.AppErrorController.error(HttpServletRequest) \nAt AppErrorController.java:[lines 56-58]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    Map<String, Object> body = getErrorAttributes(request, getTraceParameter(request));\n"
                  },
                  "startLine": 56
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AppErrorController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "  public ResponseEntity<Map<String, Object>> error(HttpServletRequest request) {\n    Map<String, Object> body = getErrorAttributes(request, getTraceParameter(request));\n"
                  },
                  "endLine": 56,
                  "startLine": 55
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "CRITICAL"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-352",
          "ruleIndex": 4
        },
        {
          "message": {
            "text": "Unrestricted Spring's RequestMapping makes the method vulnerable to CSRF attacks \nAt AppErrorController.java:[lines 34-103] \nIn class io.shiftleft.controller.AppErrorController \nIn method io.shiftleft.controller.AppErrorController.errorHtml(HttpServletRequest) \nAt AppErrorController.java:[line 45]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    return new ModelAndView(\"/errors/error\", getErrorAttributes(request, false));\n"
                  },
                  "startLine": 45
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AppErrorController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "  public ModelAndView errorHtml(HttpServletRequest request) {\n    return new ModelAndView(\"/errors/error\", getErrorAttributes(request, false));\n"
                  },
                  "endLine": 45,
                  "startLine": 44
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "CRITICAL"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-352",
          "ruleIndex": 4
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt CustomerController.java:[lines 73-388] \nIn class io.shiftleft.controller.CustomerController \nIn method io.shiftleft.controller.CustomerController.createCustomer(Customer, HttpServletResponse, WebRequest) \nAt CustomerController.java:[lines 346-352]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\t\tCustomer createdcustomer = null;\n"
                  },
                  "startLine": 346
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\n\t\tCustomer createdcustomer = null;\n"
                  },
                  "endLine": 346,
                  "startLine": 345
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt CustomerController.java:[lines 73-388] \nIn class io.shiftleft.controller.CustomerController \nIn method io.shiftleft.controller.CustomerController.getCustomer(Long) \nAt CustomerController.java:[lines 116-136]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "      if (null == customerId) {\n"
                  },
                  "startLine": 116
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\t\t/* validate customer Id parameter */\n      if (null == customerId) {\n"
                  },
                  "endLine": 116,
                  "startLine": 115
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt CustomerController.java:[lines 73-388] \nIn class io.shiftleft.controller.CustomerController \nIn method io.shiftleft.controller.CustomerController.getCustomers() \nAt CustomerController.java:[line 332]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\t\treturn (List<Customer>) customerRepository.findAll();\n"
                  },
                  "startLine": 332
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\tpublic List<Customer> getCustomers() {\n\t\treturn (List<Customer>) customerRepository.findAll();\n"
                  },
                  "endLine": 332,
                  "startLine": 331
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "This API (java/io/File.<init>(Ljava/lang/String;)V) reads a file whose location might be specified by user input \nAt CustomerController.java:[lines 73-388] \nIn class io.shiftleft.controller.CustomerController \nIn method io.shiftleft.controller.CustomerController.loadSettings(HttpServletResponse, WebRequest) \nAt CustomerController.java:[line 191] \nSink method java/io/File.<init>(Ljava/lang/String;)V \nSink parameter 0 \nUnknown source org/springframework/core/io/ClassPathResource.getPath()Ljava/lang/String;."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    \tFile folder = new File(cpr.getPath());\n"
                  },
                  "startLine": 191
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    \tClassPathResource cpr = new ClassPathResource(\"static\");\n    \tFile folder = new File(cpr.getPath());\n"
                  },
                  "endLine": 191,
                  "startLine": 190
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-22",
          "ruleIndex": 5
        },
        {
          "message": {
            "text": "This API (java/io/File.<init>(Ljava/lang/String;)V) reads a file whose location might be specified by user input \nAt CustomerController.java:[lines 73-388] \nIn class io.shiftleft.controller.CustomerController \nIn method io.shiftleft.controller.CustomerController.saveSettings(HttpServletResponse, WebRequest) \nAt CustomerController.java:[line 251] \nSink method java/io/File.<init>(Ljava/lang/String;)V \nSink parameter 0 \nUnknown source org/springframework/core/io/ClassPathResource.getPath()Ljava/lang/String; \nAt CustomerController.java:[line 248] \nAt CustomerController.java:[line 251]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\t  File file = new File(cpr.getPath()+settings[0]);\n"
                  },
                  "startLine": 251
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    ClassPathResource cpr = new ClassPathResource(\"./static/\");\n\t  File file = new File(cpr.getPath()+settings[0]);\n"
                  },
                  "endLine": 251,
                  "startLine": 250
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-22",
          "ruleIndex": 5
        },
        {
          "message": {
            "text": "Unsafe comparison of hash that are susceptible to timing attack \nAt CustomerController.java:[lines 73-388] \nIn class io.shiftleft.controller.CustomerController \nIn method io.shiftleft.controller.CustomerController.saveSettings(HttpServletResponse, WebRequest) \nAt CustomerController.java:[line 241] \nSink method java/lang/String.equals(Ljava/lang/Object;)Z \nSink parameter 0 \nUnknown source org/apache/commons/codec/digest/DigestUtils.md5Hex(Ljava/lang/String;)Ljava/lang/String;."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\tif(!cookieMD5sum.equals(calcMD5Sum))\n"
                  },
                  "startLine": 241
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    String calcMD5Sum = DigestUtils.md5Hex(base64txt);\n\tif(!cookieMD5sum.equals(calcMD5Sum))\n"
                  },
                  "endLine": 241,
                  "startLine": 240
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-203",
          "ruleIndex": 6
        },
        {
          "message": {
            "text": "This API MD5 (MDX) is not a recommended cryptographic hash function \nAt CustomerController.java:[lines 73-388] \nIn class io.shiftleft.controller.CustomerController \nIn method io.shiftleft.controller.CustomerController.saveSettings(HttpServletResponse, WebRequest) \nAt CustomerController.java:[line 240] \nValue MD5."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    String calcMD5Sum = DigestUtils.md5Hex(base64txt);\n"
                  },
                  "startLine": 240
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    String cookieMD5sum = cookie[1];\n    String calcMD5Sum = DigestUtils.md5Hex(base64txt);\n"
                  },
                  "endLine": 240,
                  "startLine": 239
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "CRITICAL"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-328",
          "ruleIndex": 7
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt PatientController.java:[lines 20-38] \nIn class io.shiftleft.controller.PatientController \nIn method io.shiftleft.controller.PatientController.getPatient() \nAt PatientController.java:[lines 34-38]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    Patient pat = patientRepository.findOne(1l);\n"
                  },
                  "startLine": 34
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/PatientController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "  public Iterable<Patient> getPatient() {\n    Patient pat = patientRepository.findOne(1l);\n"
                  },
                  "endLine": 34,
                  "startLine": 33
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "This use of org/springframework/expression/ExpressionParser.parseExpression(Ljava/lang/String;)Lorg/springframework/expression/Expression; could be vulnerable to code injection (Spring Expression) \nAt SearchController.java:[lines 18-30] \nIn class io.shiftleft.controller.SearchController \nIn method io.shiftleft.controller.SearchController.doGetSearch(String, HttpServletResponse, HttpServletRequest) \nAt SearchController.java:[line 25] \nSink method org/springframework/expression/ExpressionParser.parseExpression(Ljava/lang/String;)Lorg/springframework/expression/Expression; \nSink parameter 0 \nTainted source io/shiftleft/controller/SearchController.doGetSearch(Ljava/lang/String;Ljavax/servlet/http/HttpServletResponse;Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String; parameter 2."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "      Expression exp = parser.parseExpression(foo);\n"
                  },
                  "startLine": 25
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/SearchController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "      ExpressionParser parser = new SpelExpressionParser();\n      Expression exp = parser.parseExpression(foo);\n"
                  },
                  "endLine": 25,
                  "startLine": 24
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "CRITICAL"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-94",
          "ruleIndex": 8
        }
      ],
      "automationDetails": {
        "description": {
          "text": "Static Analysis Security Test results using @ShiftLeft/sast-scan"
        },
        "guid": "fa6c8739-679b-4178-83c6-c71020de6287"
      },
      "versionControlProvenance": [
        {
          "branch": "feature/hello-gh",
          "repositoryUri": "https://github.com/ShiftLeftSecurity/HelloShiftLeft",
          "revisionId": "ac9b463dae1fb1503cd472ef4115f085d0314bbd"
        }
      ]
    },
    {
      "tool": {
        "driver": {
          "name": "Source code analyzer",
          "rules": [
            {
              "id": "Error Prone",
              "name": "BeanMembersShouldSerialize",
              "fullDescription": "",
              "helpUri": "https://stackoverflow.com/search?q=shiftleft/sast-scan+source+Error Prone+BeanMembersShouldSerialize",
              "shortDescription": ""
            }
          ]
        }
      },
      "conversion": {
        "tool": {
          "driver": {
            "name": "@ShiftLeft/sast-scan"
          }
        },
        "invocation": {
          "arguments": [
            "pmd",
            "-no-cache",
            "--failOnViolation",
            "false",
            "-language",
            "java",
            "-version",
            "11",
            "-d",
            "/app",
            "-r",
            "/app/reports/source-report.csv",
            "-f",
            "csv",
            "-R",
            "/usr/local/src/rules-pmd.xml"
          ],
          "executionSuccessful": true,
          "commandLine": "pmd -no-cache --failOnViolation false -language java -version 11 -d /app -r /app/reports/source-report.csv -f csv -R /usr/local/src/rules-pmd.xml",
          "endTimeUtc": "2020-04-15T12:46:31Z",
          "workingDirectory": {
            "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft"
          }
        }
      },
      "invocations": [
        {
          "executionSuccessful": true,
          "endTimeUtc": "2020-04-15T12:46:31Z",
          "workingDirectory": {
            "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft"
          }
        }
      ],
      "properties": {
        "metrics": {
          "total": 31,
          "critical": 0,
          "high": 0,
          "medium": 8,
          "low": 23
        }
      },
      "results": [
        {
          "message": {
            "text": "Found non-transient, non-static member. Please mark as transient or provide accessors."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    private AccountRepository accountRepository;\n"
                  },
                  "startLine": 23
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    @Autowired\n    private AccountRepository accountRepository;\n"
                  },
                  "endLine": 23,
                  "startLine": 22
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "The String literal 'Account Data is {}' appears 6 times in this file; the first occurrence is on line 30."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        log.info(\"Account Data is {}\", this.accountRepository.findOne(1l).toString());\n"
                  },
                  "startLine": 30
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "        response.addHeader(\"test-header-detection\", new Account().toString());\n        log.info(\"Account Data is {}\", this.accountRepository.findOne(1l).toString());\n"
                  },
                  "endLine": 30,
                  "startLine": 29
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found non-transient, non-static member. Please mark as transient or provide accessors."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "  private String fail = \"redirect:/\";\n"
                  },
                  "startLine": 28
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AdminController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "public class AdminController {\n  private String fail = \"redirect:/\";\n"
                  },
                  "endLine": 28,
                  "startLine": 27
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "The String literal 'auth' appears 7 times in this file; the first occurrence is on line 52."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "  public String doGetPrintSecrets(@CookieValue(value = \"auth\", defaultValue = \"notset\") String auth, HttpServletResponse response, HttpServletRequest request) throws Exception {\n"
                  },
                  "startLine": 52
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AdminController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "  @RequestMapping(value = \"/admin/printSecrets\", method = RequestMethod.GET)\n  public String doGetPrintSecrets(@CookieValue(value = \"auth\", defaultValue = \"notset\") String auth, HttpServletResponse response, HttpServletRequest request) throws Exception {\n"
                  },
                  "endLine": 52,
                  "startLine": 51
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found 'DU'-anomaly for variable 'succ' (lines '86'-'125')."
          },
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    String succ = \"redirect:/admin/printSecrets\";\n"
                  },
                  "startLine": 86
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AdminController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "  public String doPostLogin(@CookieValue(value = \"auth\", defaultValue = \"notset\") String auth, @RequestBody String password, HttpServletResponse response, HttpServletRequest request) throws Exception {\n    String succ = \"redirect:/admin/printSecrets\";\n"
                  },
                  "endLine": 86,
                  "startLine": 85
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "MEDIUM"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Avoid using Literals in Conditional Statements."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "      if(pass.length!=2) {\n"
                  },
                  "startLine": 99
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AdminController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "      String[] pass = password.split(\"=\");\n      if(pass.length!=2) {\n"
                  },
                  "endLine": 99,
                  "startLine": 98
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found non-transient, non-static member. Please mark as transient or provide accessors."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "  private ErrorAttributes errorAttributes;\n"
                  },
                  "startLine": 26
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AppErrorController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "   */\n  private ErrorAttributes errorAttributes;\n"
                  },
                  "endLine": 26,
                  "startLine": 25
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "When doing a String.toLowerCase()/toUpperCase() call, use a Locale."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    return !\"false\".equals(parameter.toLowerCase());\n"
                  },
                  "startLine": 77
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AppErrorController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    }\n    return !\"false\".equals(parameter.toLowerCase());\n"
                  },
                  "endLine": 77,
                  "startLine": 76
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Avoid empty catch blocks."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "      catch (Exception ex) {\n"
                  },
                  "startLine": 100
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AppErrorController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "      }\n      catch (Exception ex) {\n"
                  },
                  "endLine": 100,
                  "startLine": 99
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found non-transient, non-static member. Please mark as transient or provide accessors."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\tprivate CustomerRepository customerRepository;\n"
                  },
                  "startLine": 76
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\t@Autowired\n\tprivate CustomerRepository customerRepository;\n"
                  },
                  "endLine": 76,
                  "startLine": 75
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found non-transient, non-static member. Please mark as transient or provide accessors."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\tEnvironment env;\n"
                  },
                  "startLine": 79
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\t@Autowired\n\tEnvironment env;\n"
                  },
                  "endLine": 79,
                  "startLine": 78
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found 'DD'-anomaly for variable 'ret' (lines '149'-'152')."
          },
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\t  \tString ret = \"\";\n"
                  },
                  "startLine": 149
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\t  \tClassPathResource cpr = new ClassPathResource(\"static/index.html\");\n\t  \tString ret = \"\";\n"
                  },
                  "endLine": 149,
                  "startLine": 148
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "MEDIUM"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Avoid empty catch blocks."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\t\t  } catch (IOException e) {\n"
                  },
                  "startLine": 153
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\t\t\t  ret= new String(bdata, StandardCharsets.UTF_8);\n\t\t  } catch (IOException e) {\n"
                  },
                  "endLine": 153,
                  "startLine": 152
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "The String literal 'Cookie' appears 4 times in this file; the first occurrence is on line 166."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\t\t\treturn request.getHeader(\"Cookie\").startsWith(\"settings=\");\n"
                  },
                  "startLine": 166
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "      \ttry {\n\t\t\treturn request.getHeader(\"Cookie\").startsWith(\"settings=\");\n"
                  },
                  "endLine": 166,
                  "startLine": 165
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "The String literal 'settings=' appears 4 times in this file; the first occurrence is on line 166."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\t\t\treturn request.getHeader(\"Cookie\").startsWith(\"settings=\");\n"
                  },
                  "startLine": 166
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "      \ttry {\n\t\t\treturn request.getHeader(\"Cookie\").startsWith(\"settings=\");\n"
                  },
                  "endLine": 166,
                  "startLine": 165
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found 'DU'-anomaly for variable 'md5sum' (lines '189'-'209')."
          },
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        String md5sum = request.getHeader(\"Cookie\").substring(\"settings=\".length(), 41);\n"
                  },
                  "startLine": 189
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "        }\n        String md5sum = request.getHeader(\"Cookie\").substring(\"settings=\".length(), 41);\n"
                  },
                  "endLine": 189,
                  "startLine": 188
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "MEDIUM"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found 'DD'-anomaly for variable 'filecontent' (lines '193'-'196')."
          },
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        String filecontent = new String();\n"
                  },
                  "startLine": 193
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\t\tFile[] listOfFiles = folder.listFiles();\n        String filecontent = new String();\n"
                  },
                  "endLine": 193,
                  "startLine": 192
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "MEDIUM"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found 'DU'-anomaly for variable 'filecontent' (lines '193'-'209')."
          },
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        String filecontent = new String();\n"
                  },
                  "startLine": 193
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\t\tFile[] listOfFiles = folder.listFiles();\n        String filecontent = new String();\n"
                  },
                  "endLine": 193,
                  "startLine": 192
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "MEDIUM"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found 'DD'-anomaly for variable 'filecontent' (lines '196'-'198')."
          },
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "          filecontent = new String();\n"
                  },
                  "startLine": 196
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "          // not efficient, i know\n          filecontent = new String();\n"
                  },
                  "endLine": 196,
                  "startLine": 195
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "MEDIUM"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Avoid using Literals in Conditional Statements."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\tif(cookie.length<2) {\n"
                  },
                  "startLine": 231
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    String[] cookie = settingsCookie.split(\",\");\n\tif(cookie.length<2) {\n"
                  },
                  "endLine": 231,
                  "startLine": 230
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Ensure that resources like this FileOutputStream object are closed after use."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    FileOutputStream fos = new FileOutputStream(file, true);\n"
                  },
                  "startLine": 256
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\n    FileOutputStream fos = new FileOutputStream(file, true);\n"
                  },
                  "endLine": 256,
                  "startLine": 255
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "When doing a String.toLowerCase()/toUpperCase() call, use a Locale."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    return customer1.toString().toLowerCase().replace(\"script\",\"\");\n"
                  },
                  "startLine": 306
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\n    return customer1.toString().toLowerCase().replace(\"script\",\"\");\n"
                  },
                  "endLine": 306,
                  "startLine": 305
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found 'DD'-anomaly for variable 'createdcustomer' (lines '346'-'347')."
          },
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\t\tCustomer createdcustomer = null;\n"
                  },
                  "startLine": 346
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\n\t\tCustomer createdcustomer = null;\n"
                  },
                  "endLine": 346,
                  "startLine": 345
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "MEDIUM"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found non-transient, non-static member. Please mark as transient or provide accessors."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "  private PatientRepository patientRepository;\n"
                  },
                  "startLine": 25
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/PatientController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "  @Autowired\n  private PatientRepository patientRepository;\n"
                  },
                  "endLine": 25,
                  "startLine": 24
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found 'DD'-anomaly for variable 'message' (lines '22'-'26')."
          },
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    java.lang.Object message = new Object();\n"
                  },
                  "startLine": 22
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/SearchController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "  public String doGetSearch(@RequestParam String foo, HttpServletResponse response, HttpServletRequest request) {\n    java.lang.Object message = new Object();\n"
                  },
                  "endLine": 22,
                  "startLine": 21
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "MEDIUM"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Ensure that resources like this BufferedWriter object are closed after use."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "      BufferedWriter bw = new BufferedWriter(new FileWriter(temp));\n"
                  },
                  "startLine": 35
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/data/DataBuilder.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "      // write it\n      BufferedWriter bw = new BufferedWriter(new FileWriter(temp));\n"
                  },
                  "endLine": 35,
                  "startLine": 34
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found non-transient, non-static member. Please mark as transient or provide accessors."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "  private DataBuilder dataBuilder;\n"
                  },
                  "startLine": 36
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/data/DataLoader.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "  @Autowired\n  private DataBuilder dataBuilder;\n"
                  },
                  "endLine": 36,
                  "startLine": 35
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found non-transient, non-static member. Please mark as transient or provide accessors."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "  Environment env;\n"
                  },
                  "startLine": 39
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/data/DataLoader.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "  @Autowired\n  Environment env;\n"
                  },
                  "endLine": 39,
                  "startLine": 38
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found non-transient, non-static member. Please mark as transient or provide accessors."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "  private CustomerRepository customerRepository;\n"
                  },
                  "startLine": 42
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/data/DataLoader.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "  @Autowired\n  private CustomerRepository customerRepository;\n"
                  },
                  "endLine": 42,
                  "startLine": 41
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Found non-transient, non-static member. Please mark as transient or provide accessors."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "  private PatientRepository patientRepository;\n"
                  },
                  "startLine": 45
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/data/DataLoader.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "  @Autowired\n  private PatientRepository patientRepository;\n"
                  },
                  "endLine": 45,
                  "startLine": 44
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "In J2EE, getClassLoader() might not work as expected.  Use Thread.currentThread().getContextClassLoader() instead."
          },
          "level": "note",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    props.load(this.getClass().getClassLoader().getResourceAsStream(\"config/application-mysql.properties\"));\n"
                  },
                  "startLine": 54
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/data/DataLoader.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    Properties props = new EncryptableProperties(encryptor);\n    props.load(this.getClass().getClassLoader().getResourceAsStream(\"config/application-mysql.properties\"));\n"
                  },
                  "endLine": 54,
                  "startLine": 53
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "LOW"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "Error Prone",
          "ruleIndex": 0
        }
      ],
      "automationDetails": {
        "description": {
          "text": "Static Analysis Security Test results using @ShiftLeft/sast-scan"
        },
        "guid": "a052f985-1d3d-4243-8bb7-30ce1ede7ba3"
      },
      "versionControlProvenance": [
        {
          "branch": "feature/hello-gh",
          "repositoryUri": "https://github.com/ShiftLeftSecurity/HelloShiftLeft",
          "revisionId": "ac9b463dae1fb1503cd472ef4115f085d0314bbd"
        }
      ]
    }
  ],
  "version": "2.1.0",
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "inlineExternalProperties": [
    {
      "guid": "11401526-4506-4576-b170-7f7a6cbb55f7",
      "runGuid": "015fa916-8332-4a86-a06f-c64020dbe59b"
    }
  ]
}