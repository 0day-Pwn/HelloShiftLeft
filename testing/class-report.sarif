{
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "Class file analyzer",
          "rules": [
            {
              "id": "CWE-212",
              "name": "Unexpected property leak",
              "helpUri": "https://cwe.mitre.org/data/definitions/212.html"
            },
            {
              "id": "CWE-915",
              "name": "Mass assignment",
              "helpUri": "https://cwe.mitre.org/data/definitions/915.html"
            },
            {
              "id": "CWE-502",
              "name": "Object deserialization is used in {1}",
              "helpUri": "https://cwe.mitre.org/data/definitions/502.html"
            },
            {
              "id": "CWE-79",
              "name": "Potential XSS in Servlet",
              "helpUri": "https://cwe.mitre.org/data/definitions/79.html"
            },
            {
              "id": "CWE-352",
              "name": "Spring CSRF unrestricted RequestMapping",
              "helpUri": "https://cwe.mitre.org/data/definitions/352.html"
            },
            {
              "id": "CWE-22",
              "name": "Potential Path Traversal (file read)",
              "helpUri": "https://cwe.mitre.org/data/definitions/22.html"
            },
            {
              "id": "CWE-203",
              "name": "Unsafe hash equals",
              "helpUri": "https://cwe.mitre.org/data/definitions/203.html"
            },
            {
              "id": "CWE-328",
              "name": "MD2, MD4 and MD5 are weak hash functions",
              "helpUri": "https://cwe.mitre.org/data/definitions/328.html"
            },
            {
              "id": "CWE-94",
              "name": "Potential code injection when using Spring Expression",
              "helpUri": "https://cwe.mitre.org/data/definitions/94.html"
            }
          ]
        }
      },
      "conversion": {
        "tool": {
          "driver": {
            "name": "@ShiftLeft/sast-scan"
          }
        },
        "invocation": {
          "arguments": [
            "-jar",
            "/opt/spotbugs/lib/spotbugs.jar",
            "-textui",
            "-include",
            "/usr/local/src/spotbugs/include.xml",
            "-exclude",
            "/usr/local/src/spotbugs/exclude.xml",
            "-noClassOk",
            "-auxclasspathFromFile",
            "/tmp/tmpkqe09gqt",
            "-sourcepath",
            "/app",
            "-quiet",
            "-medium",
            "-xml:withMessages",
            "-effort:max",
            "-nested:false",
            "-output",
            "/app/reports/class-report.xml",
            "/app"
          ],
          "executionSuccessful": true,
          "commandLine": "-jar /opt/spotbugs/lib/spotbugs.jar -textui -include /usr/local/src/spotbugs/include.xml -exclude /usr/local/src/spotbugs/exclude.xml -noClassOk -auxclasspathFromFile /tmp/tmpkqe09gqt -sourcepath /app -quiet -medium -xml:withMessages -effort:max -nested:false -output /app/reports/class-report.xml /app",
          "endTimeUtc": "2020-04-09T19:24:05Z",
          "workingDirectory": {
            "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft"
          }
        }
      },
      "invocations": [
        {
          "executionSuccessful": true,
          "endTimeUtc": "2020-04-09T19:24:05Z",
          "workingDirectory": {
            "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft"
          }
        }
      ],
      "properties": {
        "metrics": {
          "total": 20,
          "critical": 5,
          "high": 15,
          "medium": 0,
          "low": 0
        }
      },
      "results": [
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt AccountController.java:[lines 21-71] \nIn class io.shiftleft.controller.AccountController \nIn method io.shiftleft.controller.AccountController.addInterestToAccount(double, long) \nAt AccountController.java:[lines 67-71]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        Account account = this.accountRepository.findOne(accountId);\n"
                  },
                  "startLine": 67
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    public Account addInterestToAccount(@RequestParam double amount, @PathVariable long accountId) {\n        Account account = this.accountRepository.findOne(accountId);\n"
                  },
                  "endLine": 67,
                  "startLine": 66
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt AccountController.java:[lines 21-71] \nIn class io.shiftleft.controller.AccountController \nIn method io.shiftleft.controller.AccountController.createAccount(Account) \nAt AccountController.java:[lines 36-38]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        this.accountRepository.save(account);\n"
                  },
                  "startLine": 36
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    public Account createAccount(Account account) {\n        this.accountRepository.save(account);\n"
                  },
                  "endLine": 36,
                  "startLine": 35
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt AccountController.java:[lines 21-71] \nIn class io.shiftleft.controller.AccountController \nIn method io.shiftleft.controller.AccountController.depositIntoAccount(double, long) \nAt AccountController.java:[lines 49-53]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        Account account = this.accountRepository.findOne(accountId);\n"
                  },
                  "startLine": 49
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    public Account depositIntoAccount(@RequestParam double amount, @PathVariable long accountId) {\n        Account account = this.accountRepository.findOne(accountId);\n"
                  },
                  "endLine": 49,
                  "startLine": 48
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt AccountController.java:[lines 21-71] \nIn class io.shiftleft.controller.AccountController \nIn method io.shiftleft.controller.AccountController.getAccount(long) \nAt AccountController.java:[lines 43-44]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        log.info(\"Account Data is {}\", this.accountRepository.findOne(1l).toString());\n"
                  },
                  "startLine": 43
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    public Account getAccount(@PathVariable long accountId) {\n        log.info(\"Account Data is {}\", this.accountRepository.findOne(1l).toString());\n"
                  },
                  "endLine": 43,
                  "startLine": 42
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt AccountController.java:[lines 21-71] \nIn class io.shiftleft.controller.AccountController \nIn method io.shiftleft.controller.AccountController.getAccountList(HttpServletResponse, HttpServletRequest) \nAt AccountController.java:[lines 29-31]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        response.addHeader(\"test-header-detection\", new Account().toString());\n"
                  },
                  "startLine": 29
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    public Iterable<Account> getAccountList(HttpServletResponse response, HttpServletRequest request) {\n        response.addHeader(\"test-header-detection\", new Account().toString());\n"
                  },
                  "endLine": 29,
                  "startLine": 28
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt AccountController.java:[lines 21-71] \nIn class io.shiftleft.controller.AccountController \nIn method io.shiftleft.controller.AccountController.withdrawFromAccount(double, long) \nAt AccountController.java:[lines 58-62]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        Account account = this.accountRepository.findOne(accountId);\n"
                  },
                  "startLine": 58
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    public Account withdrawFromAccount(@RequestParam double amount, @PathVariable long accountId) {\n        Account account = this.accountRepository.findOne(accountId);\n"
                  },
                  "endLine": 58,
                  "startLine": 57
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "The persistent objects could be exploited by attacker to read sensitive information. \nAt AccountController.java:[lines 21-71] \nIn class io.shiftleft.controller.AccountController \nIn method io.shiftleft.controller.AccountController.createAccount(Account) \nAt AccountController.java:[lines 36-38]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "        this.accountRepository.save(account);\n"
                  },
                  "startLine": 36
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AccountController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    public Account createAccount(Account account) {\n        this.accountRepository.save(account);\n"
                  },
                  "endLine": 36,
                  "startLine": 35
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-915",
          "ruleIndex": 1
        },
        {
          "message": {
            "text": "Object deserialization is used in io.shiftleft.controller.AdminController.isAdmin(String) \nAt AdminController.java:[lines 27-135] \nIn class io.shiftleft.controller.AdminController \nIn method io.shiftleft.controller.AdminController.isAdmin(String) \nAt AdminController.java:[line 36]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "      Object authToken = objectInputStream.readObject();\n"
                  },
                  "startLine": 36
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AdminController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "      ObjectInputStream objectInputStream = new ObjectInputStream(bis);\n      Object authToken = objectInputStream.readObject();\n"
                  },
                  "endLine": 36,
                  "startLine": 35
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "CRITICAL"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-502",
          "ruleIndex": 2
        },
        {
          "message": {
            "text": "This use of javax/servlet/ServletOutputStream.println(Ljava/lang/String;)V could be vulnerable to XSS in the Servlet \nAt AdminController.java:[lines 27-135] \nIn class io.shiftleft.controller.AdminController \nIn method io.shiftleft.controller.AdminController.doGetPrintSecrets(String, HttpServletResponse, HttpServletRequest) \nAt AdminController.java:[line 66] \nSink method javax/servlet/ServletOutputStream.println(Ljava/lang/String;)V \nSink parameter 0 \nAt AdminController.java:[line 66]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "      response.getOutputStream().println(new String(bdata, StandardCharsets.UTF_8));\n"
                  },
                  "startLine": 66
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AdminController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "      byte[] bdata = FileCopyUtils.copyToByteArray(cpr.getInputStream());\n      response.getOutputStream().println(new String(bdata, StandardCharsets.UTF_8));\n"
                  },
                  "endLine": 66,
                  "startLine": 65
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-79",
          "ruleIndex": 3
        },
        {
          "message": {
            "text": "Unrestricted Spring's RequestMapping makes the method vulnerable to CSRF attacks \nAt AppErrorController.java:[lines 34-103] \nIn class io.shiftleft.controller.AppErrorController \nIn method io.shiftleft.controller.AppErrorController.error(HttpServletRequest) \nAt AppErrorController.java:[lines 56-58]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    Map<String, Object> body = getErrorAttributes(request, getTraceParameter(request));\n"
                  },
                  "startLine": 56
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AppErrorController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "  public ResponseEntity<Map<String, Object>> error(HttpServletRequest request) {\n    Map<String, Object> body = getErrorAttributes(request, getTraceParameter(request));\n"
                  },
                  "endLine": 56,
                  "startLine": 55
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "CRITICAL"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-352",
          "ruleIndex": 4
        },
        {
          "message": {
            "text": "Unrestricted Spring's RequestMapping makes the method vulnerable to CSRF attacks \nAt AppErrorController.java:[lines 34-103] \nIn class io.shiftleft.controller.AppErrorController \nIn method io.shiftleft.controller.AppErrorController.errorHtml(HttpServletRequest) \nAt AppErrorController.java:[line 45]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    return new ModelAndView(\"/errors/error\", getErrorAttributes(request, false));\n"
                  },
                  "startLine": 45
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/AppErrorController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "  public ModelAndView errorHtml(HttpServletRequest request) {\n    return new ModelAndView(\"/errors/error\", getErrorAttributes(request, false));\n"
                  },
                  "endLine": 45,
                  "startLine": 44
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "CRITICAL"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-352",
          "ruleIndex": 4
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt CustomerController.java:[lines 73-388] \nIn class io.shiftleft.controller.CustomerController \nIn method io.shiftleft.controller.CustomerController.createCustomer(Customer, HttpServletResponse, WebRequest) \nAt CustomerController.java:[lines 346-352]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\t\tCustomer createdcustomer = null;\n"
                  },
                  "startLine": 346
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\n\t\tCustomer createdcustomer = null;\n"
                  },
                  "endLine": 346,
                  "startLine": 345
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt CustomerController.java:[lines 73-388] \nIn class io.shiftleft.controller.CustomerController \nIn method io.shiftleft.controller.CustomerController.getCustomer(Long) \nAt CustomerController.java:[lines 116-136]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "      if (null == customerId) {\n"
                  },
                  "startLine": 116
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\t\t/* validate customer Id parameter */\n      if (null == customerId) {\n"
                  },
                  "endLine": 116,
                  "startLine": 115
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt CustomerController.java:[lines 73-388] \nIn class io.shiftleft.controller.CustomerController \nIn method io.shiftleft.controller.CustomerController.getCustomers() \nAt CustomerController.java:[line 332]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\t\treturn (List<Customer>) customerRepository.findAll();\n"
                  },
                  "startLine": 332
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "\tpublic List<Customer> getCustomers() {\n\t\treturn (List<Customer>) customerRepository.findAll();\n"
                  },
                  "endLine": 332,
                  "startLine": 331
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "This API (java/io/File.<init>(Ljava/lang/String;)V) reads a file whose location might be specified by user input \nAt CustomerController.java:[lines 73-388] \nIn class io.shiftleft.controller.CustomerController \nIn method io.shiftleft.controller.CustomerController.loadSettings(HttpServletResponse, WebRequest) \nAt CustomerController.java:[line 191] \nSink method java/io/File.<init>(Ljava/lang/String;)V \nSink parameter 0 \nUnknown source org/springframework/core/io/ClassPathResource.getPath()Ljava/lang/String;."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    \tFile folder = new File(cpr.getPath());\n"
                  },
                  "startLine": 191
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    \tClassPathResource cpr = new ClassPathResource(\"static\");\n    \tFile folder = new File(cpr.getPath());\n"
                  },
                  "endLine": 191,
                  "startLine": 190
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-22",
          "ruleIndex": 5
        },
        {
          "message": {
            "text": "This API (java/io/File.<init>(Ljava/lang/String;)V) reads a file whose location might be specified by user input \nAt CustomerController.java:[lines 73-388] \nIn class io.shiftleft.controller.CustomerController \nIn method io.shiftleft.controller.CustomerController.saveSettings(HttpServletResponse, WebRequest) \nAt CustomerController.java:[line 251] \nSink method java/io/File.<init>(Ljava/lang/String;)V \nSink parameter 0 \nUnknown source org/springframework/core/io/ClassPathResource.getPath()Ljava/lang/String; \nAt CustomerController.java:[line 248] \nAt CustomerController.java:[line 251]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\t  File file = new File(cpr.getPath()+settings[0]);\n"
                  },
                  "startLine": 251
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    ClassPathResource cpr = new ClassPathResource(\"./static/\");\n\t  File file = new File(cpr.getPath()+settings[0]);\n"
                  },
                  "endLine": 251,
                  "startLine": 250
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-22",
          "ruleIndex": 5
        },
        {
          "message": {
            "text": "Unsafe comparison of hash that are susceptible to timing attack \nAt CustomerController.java:[lines 73-388] \nIn class io.shiftleft.controller.CustomerController \nIn method io.shiftleft.controller.CustomerController.saveSettings(HttpServletResponse, WebRequest) \nAt CustomerController.java:[line 241] \nSink method java/lang/String.equals(Ljava/lang/Object;)Z \nSink parameter 0 \nUnknown source org/apache/commons/codec/digest/DigestUtils.md5Hex(Ljava/lang/String;)Ljava/lang/String;."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "\tif(!cookieMD5sum.equals(calcMD5Sum))\n"
                  },
                  "startLine": 241
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    String calcMD5Sum = DigestUtils.md5Hex(base64txt);\n\tif(!cookieMD5sum.equals(calcMD5Sum))\n"
                  },
                  "endLine": 241,
                  "startLine": 240
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-203",
          "ruleIndex": 6
        },
        {
          "message": {
            "text": "This API MD5 (MDX) is not a recommended cryptographic hash function \nAt CustomerController.java:[lines 73-388] \nIn class io.shiftleft.controller.CustomerController \nIn method io.shiftleft.controller.CustomerController.saveSettings(HttpServletResponse, WebRequest) \nAt CustomerController.java:[line 240] \nValue MD5."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    String calcMD5Sum = DigestUtils.md5Hex(base64txt);\n"
                  },
                  "startLine": 240
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/CustomerController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "    String cookieMD5sum = cookie[1];\n    String calcMD5Sum = DigestUtils.md5Hex(base64txt);\n"
                  },
                  "endLine": 240,
                  "startLine": 239
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "CRITICAL"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-328",
          "ruleIndex": 7
        },
        {
          "message": {
            "text": "Unexpected property could be leaked because a persistence class is directly exposed to the client \nAt PatientController.java:[lines 20-38] \nIn class io.shiftleft.controller.PatientController \nIn method io.shiftleft.controller.PatientController.getPatient() \nAt PatientController.java:[lines 34-38]."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "    Patient pat = patientRepository.findOne(1l);\n"
                  },
                  "startLine": 34
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/PatientController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "  public Iterable<Patient> getPatient() {\n    Patient pat = patientRepository.findOne(1l);\n"
                  },
                  "endLine": 34,
                  "startLine": 33
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "HIGH"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-212",
          "ruleIndex": 0
        },
        {
          "message": {
            "text": "This use of org/springframework/expression/ExpressionParser.parseExpression(Ljava/lang/String;)Lorg/springframework/expression/Expression; could be vulnerable to code injection (Spring Expression) \nAt SearchController.java:[lines 18-30] \nIn class io.shiftleft.controller.SearchController \nIn method io.shiftleft.controller.SearchController.doGetSearch(String, HttpServletResponse, HttpServletRequest) \nAt SearchController.java:[line 25] \nSink method org/springframework/expression/ExpressionParser.parseExpression(Ljava/lang/String;)Lorg/springframework/expression/Expression; \nSink parameter 0 \nTainted source io/shiftleft/controller/SearchController.doGetSearch(Ljava/lang/String;Ljavax/servlet/http/HttpServletResponse;Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String; parameter 2."
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "region": {
                  "snippet": {
                    "text": "      Expression exp = parser.parseExpression(foo);\n"
                  },
                  "startLine": 25
                },
                "artifactLocation": {
                  "uri": "file:///home/runner/work/HelloShiftLeft/HelloShiftLeft/src/main/java/io/shiftleft/controller/SearchController.java"
                },
                "contextRegion": {
                  "snippet": {
                    "text": "      ExpressionParser parser = new SpelExpressionParser();\n      Expression exp = parser.parseExpression(foo);\n"
                  },
                  "endLine": 25,
                  "startLine": 24
                }
              }
            }
          ],
          "properties": {
            "issue_confidence": "LOW",
            "issue_severity": "CRITICAL"
          },
          "hostedViewerUri": "https://sarifviewer.azurewebsites.net",
          "ruleId": "CWE-94",
          "ruleIndex": 8
        }
      ],
      "automationDetails": {
        "description": {
          "text": "Static Analysis Security Test results using @ShiftLeft/sast-scan"
        },
        "guid": "b893b339-53d2-4425-8a61-e53750329ed6"
      },
      "versionControlProvenance": [
        {
          "branch": "feature/dispatch-poc",
          "repositoryUri": "https://github.com/ShiftLeftSecurity/HelloShiftLeft",
          "revisionId": "3fecf84a30b763881cf51ffd64bb264f487a8bd5"
        }
      ]
    }
  ],
  "version": "2.1.0",
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "inlineExternalProperties": [
    {
      "guid": "b893b339-53d2-4425-8a61-e53750329ed6",
      "runGuid": "ac24df8e-1df2-4f34-b7a9-e0d2be27816c"
    }
  ]
}